(function(){var a,b,c,d,e,f,g,h={}.hasOwnProperty,i=function(a,b){function c(){this.constructor=a}for(var d in b)h.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};e=function(){function a(a,c,d){this.element=a,this.options=$.extend({},b,c),this.instanceName=d,this.defaults=b}var b;return b={debug:!1,messageScope:"warning"},a.prototype.log=function(a,b){var c,d,e,f;null==b&&(b="info"),this.options.debug===!0&&(d="",e=!0,"error"===this.options.messageScope&&"info"===b&&(e=!1),"error"===this.options.messageScope&&"warning"===b&&(e=!1),"warning"===this.options.messageScope&&"info"===b&&(e=!1),"info"===b&&(f="background: white; color: grey",c="background: white; color: green"),"error"===b&&(f="background: red; color: white",c="background: white; color: red",d="(Error!)"),"warning"===b&&(f="background: white; color: orange",c="background: white; color: orange",d="(Warning)"),e&&console.log("%c "+this.instanceName+": "+d+" %c "+a,f,c))},a.prototype.getPluginByInstanceName=function(a,b,c){return null==c&&(c=-1),$.data(a,b)},a.prototype.runForEachInstance=function(a,b){var c,d;c=0,d=this.pluginName,$(a).each(function(){return c+=1,null!=$.data(this,d+"_"+c)?b($.data(this,d+"_"+c)):null!=$.data(this,d+"_#"+$(this).attr("id"))?b($.data(this,d+"_#"+$(this).attr("id"))):void 0})},a}(),a=function(){function a(a,b,c){this.base=a,this.parent=b,this.langCode=c,this.parent.find(".editor").hide(),1===this.parent.find("#"+this.langCode).length?(this.mode="edit",this._currentElement=this.parent.find("#"+this.langCode),this._currentElement.show(),this.base.log("["+this.langCode+"] "+this.Type+" ready for edit")):(this._currentElement=$(this.editorHtml),this._currentElement.appendTo(this.parent),this.base.log("New "+this.Type+" ["+this.langCode+"] created"))}return a.Type="editor",a.mode="new",a.editorHtml='<div id="'+a.langCode+'" class="editor toRemove" >\n  <textarea class="m-wrap new-word" placeholder="Text to translate" rows="1"></textarea>\n</div>',a.prototype.save=function(){this._currentElement.removeClass("toRemove"),this.base.languageTabs.buttonExists(this.langCode)||this.base.languageTabs.addButton(this.langCode),this.base.log(""+this.Type+" ["+this.langCode+"] saved"),this.base.languageTabs.highlight(this.langCode)},a.prototype.discard=function(){this._currentElement.hasClass("toRemove")&&(this._currentElement.remove(),this.base.log(""+this.Type+" ["+this.langCode+"] removed"))},a.prototype.remove=function(){this._currentElement.remove(),this.base.log(""+this.Type+" ["+this.langCode+"] removed manually")},a.prototype.getElement=function(){return this._currentElement},a}(),f=function(a){function b(a,c,d,e){var f;null==e&&(e=""),this.Type="TextEditor",f=a.options.inputNamePrefix+a.instanceName+("["+d+"]"),this.editorHtml='<div id="'+d+'" class="editor toRemove" >\n  <textarea name="'+f+'" class="m-wrap new-word" placeholder="Text to translate" rows="1"></textarea>\n</div>',b.__super__.constructor.call(this,a,c,d),""!==e&&this._currentElement.find(".new-word").val(e),"edit"===this.mode?(this._currentElement.data("current",this._currentElement.find(".new-word").val()),this.parent.find(".apply").text("Update")):this.parent.find(".apply").text("Apply")}return i(b,a),b.prototype.save=function(){return this._currentElement.removeData("current"),b.__super__.save.call(this)},b.prototype.discard=function(){b.__super__.discard.call(this),this._currentElement.hasClass("toRemove")||this._currentElement.data("current")&&(this._currentElement.find(".new-word").val(this._currentElement.data("current")),this.base.log("Changes in TextEditor ["+this.langCode+"] discarded"))},b}(a),c=function(a){function b(a,c,d,e){var f;null==e&&(e=""),this.Type="FileEditor",f=a.instanceName+("["+d+"]"),this.editorHtml='<div id="'+d+'" class="editor toRemove" >\n  <input name="'+f+'" type="file" />\n  <div class="infoText">'+e+"</div>\n</div>",b.__super__.constructor.call(this,a,c,d),this.parent.find(".apply").text("Save"),"edit"===this.mode?(this.parent.find(".apply").hide(),this._currentElement.css("height","50px")):(this.parent.find(".apply").show(),this._currentElement.css("height","auto")),this._currentElement.find("input[type=file]").on("change."+this.base.pluginName,function(a){return function(){return a.base.languageTabs.highlight(a.langCode)}}(this))}return i(b,a),b}(a),b=function(){function a(a){var b;this.base=a,this._render(),this.base.log("Editor Window rendered"),this.status="closed",b=this._currentElement.find(".apply"),b.on("click."+this.base.pluginName,function(a){return function(c){c.preventDefault(),a.currentEditor.save(),a.setOptionAsTranslated(a.translation),b.text("Update")}}(this))}return a.prototype.show=function(a){return null==a&&(a="new"),"open"===this.status&&a===this.translation?void this.hide():(this.translation=a,this.base.closeAllEditors(),this._createLangList(),this._setEditorFor(this.translation),$(this.base.baseElement).find(".input-prepend").addClass("show"),this.status="open",void this.base.log("Show editor window (translation: "+this.translation+")"))},a.prototype._setEditorFor=function(a,b){var d;null==b&&(b=""),d=this._currentElement.find(".editors"),"new"===a?d.hide():(this.currentEditor="text"===this.base._inputType?new f(this.base,d,a,b):new c(this.base,d,a),d.show())},a.prototype._createLangList=function(){var a;this.langList=$("<select />",{"class":"select-language",tabindex:1}),a=this.base.options.customSelectLabel,this.langList.append('<option value="new">'+a+"</option>"),$.each(this.base.languages,function(a){return function(b,c){var d;return d=$('<option value="'+b+'">'+c+"</option>"),a.base.languageTabs.buttonExists(b)&&d.addClass("translated"),a.langList.append(d)}}(this)),this.langList.find('option[value="'+this.translation+'"]').attr("selected","selected"),this.langList.on("change."+this.base.pluginName,function(a){return function(){return a.translation=a.langList.val(),null!=a.currentEditor&&a.currentEditor.discard(),a._setEditorFor(a.langList.val())}}(this)),this._currentElement.find(".translation-content").prepend(this.langList),this.base.log("List of languages created")},a.prototype.setOptionAsTranslated=function(a){this.langlist=this._currentElement.find("select"),this.langlist.find('option[value="'+a+'"]').addClass("translated")},a.prototype.removeLang=function(a){this._setEditorFor(a),this.currentEditor.remove()},a.prototype.addLang=function(a,b){return null!=this.base.languages[a]?(this._setEditorFor(a,b),this.currentEditor.save()):this.base.log("There is no "+a+" language","warning")},a.prototype.hide=function(){"open"===this.status&&(this.base.log("Hide editor window"),$(this.base.baseElement).find(".input-prepend").removeClass("show"),this.langList.remove(),null!=this.currentEditor&&this.currentEditor.discard(),this.status="closed")},a.prototype._render=function(){var a;a='<div class="translation-options">\n  <div class="translation-content">\n    <div class="current-language">\n      <div class="editors">\n        <a href="#" class="btn blue apply">Apply</a>\n      </div>\n      <span class="hide-border"></span>\n    </div>\n  </div>\n</div>',$(a).insertAfter(this.base.baseElement.find(".lang-translation")),this._currentElement=this.base.baseElement.find(".translation-options")},a}(),d=function(){function a(a){this.base=a,this.buttons=[],this.base.log("Language tabs created"),this._render(),this.baseInputWidth=parseInt(this.base.baseElement.find(".lang-translation").width()),this.tglBtnWidth=parseInt(this.base.baseElement.find(".open-translation").width()),this.tglBtnMarginRight=parseInt(this.base.baseElement.find(".open-translation").css("marginRight"))}return a.prototype._render=function(){var a;return a='<div class="language-tabs"></div>',$(a).insertAfter(this.base.baseElement.find(".translation-options")),this._currentElement=this.base.baseElement.find(".language-tabs"),this.base.log("Language tabs rendered")},a.prototype.addButton=function(a){var b,c;return this.buttonExists(a)?void this.base.log("Cannot add ["+a+"]! Button exists.","error"):(c=$('<span id="'+a+'" class="chosen-language"/>').text(a),b=$('<a href="#" class="remove icon icon-remove" />'),b.appendTo(c),b.on("click."+this.base.pluginName,function(b){return function(c){return c.preventDefault(),c.stopPropagation(),b.base.showConfirmBox(function(){b.removeLanguage(a)})}}(this)),c.on("click."+this.base.pluginName,function(b){return function(){return b.base.log("LangBtn ["+a+"] clicked"),b.base.edWindow.show(a)}}(this)),c.appendTo(this._currentElement),this.base.log("Button added: "+a),this._updateInputWidth(),void this.base._checkTranslationExistence())},a.prototype.removeLanguage=function(a){this.base.edWindow.removeLang(a),this.base.edWindow.hide(),this._currentElement.find("#"+a).fadeOut(function(b){return function(){b._currentElement.find("#"+a).remove(),b.base.log("Button ["+a+"] removed"),b._updateInputWidth(),b.base._checkTranslationExistence()}}(this))},a.prototype.buttonExists=function(a){return 1===this._currentElement.find("#"+a).length?!0:!1},a.prototype.getAllLanguages=function(){var a,b;return b=new Array,a=this._currentElement.find(".chosen-language"),a.each(function(){return b.push($(this).attr("id"))}),b},a.prototype.highlight=function(a){var b;b=this._currentElement.find("#"+a),b.hasClass("highlight")?b.replaceWith(b.clone(!0)):b.addClass("highlight")},a.prototype._updateInputWidth=function(){var a,b,c,d,e,f;f=8,d=this._currentElement.children("span"),a=parseInt(d.css("marginLeft"))+parseInt(d.css("marginRight")),b=parseInt(d.css("paddingLeft"))+parseInt(d.css("paddingRight")),c=parseInt(d.width())+b+a,e=c*d.length+this.tglBtnWidth+this.tglBtnMarginRight+f,this.base.baseElement.find(".lang-translation").width(e>this.baseInputWidth?e+f:this.baseInputWidth)},a}(),g=function(a){function c(a,b,d,g,h){var i;return this.pluginName=g,b=$.extend({},f,b),this.languages=b.useDefaultLanguages?$.extend(!0,{},e,h):h,d=$(a).parents(".control-group").find("label").text().replace(" ","_"),d=d,c.__super__.constructor.call(this,a,b,d,h),this._currentElement=$(a),i=this._currentElement.prop("tagName").toLowerCase(),"input"!==i?void this.log("Element should be HTML <input />","error"):void this._constructSkeleton()}var e,f;return i(c,a),f={dataSource:"json",useDefaultLanguages:!0,inputNamePrefix:"",customSelectLabel:"Please Select",confirmBox:{yesText:"Yes, delete",noText:"No, go away!",infoMessage:"Are you sure ?",hText:"Confirm your request",outerClick:!1,useKeys:!0}},e={PL:"Polish",EN:"English",FR:"French",ES:"Spanish",DE:"German"},c.prototype.init=function(){this.baseElement=this._currentElement.parents(".control-group"),this._inputType=this._currentElement.attr("type").toLowerCase(),"file"===this._inputType&&(this.log("Input type is file"),this._currentElement.attr("type","text").addClass("replacement")),this._createToggleBtn(),this.edWindow=new b(this),this.languageTabs=new d(this),this.tglBtn.on("click."+this.pluginName,function(a){return function(){return a.log("toggleBtn clicked!"),a.edWindow.show()}}(this)),$("body").off("click."+this.pluginName),$("body").on("click."+this.pluginName,function(a){return function(){return a.closeAllEditors()}}(this)),$(this.baseElement).on("click."+this.pluginName,function(a){a.stopPropagation()}),this._fillData()},c.prototype.clearData=function(a){var b,c,d,e;if(null==a&&(a=!0),c=this.languageTabs.getAllLanguages(),a)this.showConfirmBox(function(a){return function(){var b,d,e;for(d=0,e=c.length;e>d;d++)b=c[d],a.languageTabs.removeLanguage(b)}}(this));else for(d=0,e=c.length;e>d;d++)b=c[d],this.languageTabs.removeLanguage(b)},c.prototype._constructSkeleton=function(){var a;a=$("<div />",{"class":"input-prepend form-translation"}),this._currentElement.wrap(a)},c.prototype._createToggleBtn=function(){var a;return a='<span class="add-on open-translation">\n  <i class="icon icon-options"></i>\n</span>',$(a).insertBefore(this.baseElement.find(".lang-translation")),this.tglBtn=this.baseElement.find(".open-translation")},c.prototype._fillData=function(){var a;a=null,$.isFunction(this.options.dataSource)?(this.log("dataSource is a function"),this._processDataForEach(this.options.dataSource(this.instanceName))):"object"==typeof this.options.dataSource?(this.log("dataSource is an object"),this._processDataForEach(this.options.dataSource)):this.log("No data source","warning")},c.prototype._processDataForEach=function(a){return this.runForEachInstance("input.lang-translation",function(b){var c,d,e;c=a[b.instanceName];for(d in c)e=c[d],b.edWindow.addLang(d,e)})},c.prototype.closeAllEditors=function(){this.log("Closing all editor windows"),$("body").find(".control-group").removeClass("show"),this.runForEachInstance("input.lang-translation",function(a){return a.edWindow.hide()})},c.prototype.showConfirmBox=function(a){var b,c;b='<div id="confirmOverlay">\n  <div id="confirmBox">\n    <h1>'+this.options.confirmBox.hText+"</h1>\n    <p>"+this.options.confirmBox.infoMessage+'</p>\n    <div id="confirmButtons" style="color: black">\n      <a class="button yes" id="removeYes" href="#">\n        '+this.options.confirmBox.yesText+'\n      </a>\n      <a class="button no" id="removeNo" href="#">\n        '+this.options.confirmBox.noText+"\n      </a>\n    </div>\n  </div>\n</div>",c=$(b),c.find("#removeYes").on("click."+this.pluginName,function(){return function(b){b.preventDefault(),a(),c.remove()}}(this)),c.find("#removeNo").on("click."+this.pluginName,function(){return function(a){a.preventDefault(),c.remove()}}(this)),c.hide().appendTo("body").fadeIn()},c.prototype._checkTranslationExistence=function(){this._currentElement.val(this.languageTabs.getAllLanguages().length>0?"filled":"")},c}(e),function(a){var b;b="translationWidget",a.fn[b]=function(c,d){var e,f;e=0,f=this.length,this.each(function(){var h,i;return e+=1,1===f&&(e="#"+a(this).attr("id")),h=b+"_"+e,i=new g(this,c,h,b,d),a.data(this,h)?void 0:(a.data(this,h,i),i.init())})}}(jQuery,window,document)}).call(this);